"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[576],{3576:(ho,h,d)=>{d.r(h),d.d(h,{AuthModule:()=>go});var p=d(1368),u=d(422),c=d(1528),o=d(4496),g=d(4600),s=d(4716),C=d(616);const E=()=>["/user/perfil"];function v(e,a){1&e&&(o.I0R(0,"div",2)(1,"h3")(2,"i"),o.OEk(3,"Bienvienido"),o.C$Y()(),o.I0R(4,"div",0)(5,"button",3),o.OEk(6,"ver perfil"),o.C$Y()()()),2&e&&(o.yG2(5),o.E7m("routerLink",o.q4q(1,E)))}const b=(e,a)=>({"background-color":e,color:a});function R(e,a){if(1&e){const i=o.KQA();o.I0R(0,"div",0)(1,"button",4),o.qCj("click",function(){const r=o.usT(i).$implicit,l=o.GaO(4);return o.CGJ(l.loginWithProvider(r))}),o.OEk(2),o.C$Y()()}if(2&e){const i=a.$implicit;o.yG2(),o.E7m("ngStyle",o.IBC(2,b,i.color,i.textColor)),o.yG2(),o.oRS(" ",i.name," ")}}function O(e,a){if(1&e&&o.c53(0,R,3,5,"div",5,o.wJt),2&e){const i=o.GaO(3);o.oho(i.providers)}}function x(e,a){1&e&&(o.I0R(0,"span")(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function y(e,a){1&e&&(o.I0R(0,"span",22)(1,"i"),o.OEk(2,"Ingresa un email "),o.I0R(3,"strong"),o.OEk(4,"v\xe1lido"),o.C$Y()()())}function k(e,a){if(1&e){const i=o.KQA();o.I0R(0,"div",14)(1,"form",15),o.qCj("ngSubmit",function(){o.usT(i);const t=o.GaO(4);return o.CGJ(t.resetPassword())}),o.I0R(2,"div",16)(3,"label"),o.OEk(4,"Email"),o.C$Y(),o.wR5(5,"input",17),o.yuY(6,x,5,0,"span",18)(7,y,5,0,"span",19),o.C$Y(),o.I0R(8,"div",0)(9,"button",20)(10,"strong"),o.OEk(11,"enviar correo"),o.C$Y()(),o.I0R(12,"button",21),o.qCj("click",function(){o.usT(i);const t=o.GaO(4);return o.CGJ(t.enableResetPassword=!1)}),o.OEk(13," cancelar "),o.C$Y()()()()}if(2&e){const i=o.GaO(4);o.yG2(),o.E7m("formGroup",i.datosForm),o.yG2(5),o.E7m("ngIf",i.datosForm.controls.email.hasError("required")),o.yG2(),o.E7m("ngIf",i.datosForm.controls.email.hasError("email")),o.yG2(2),o.E7m("disabled",i.cargando)}}const I=()=>["/user/registro"];function P(e,a){if(1&e){const i=o.KQA();o.I0R(0,"div",0)(1,"button",6),o.qCj("click",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.enableLoginWithEmailAndPassword=!1)}),o.OEk(2," Iniciar sesi\xf3n con otro m\xe9todo "),o.C$Y()(),o.I0R(3,"div",7)(4,"div")(5,"p"),o.OEk(6,"Email:"),o.C$Y(),o.I0R(7,"div",0)(8,"input",8),o.iHE("ngModelChange",function(t){o.usT(i);const r=o.GaO(3);return o.kNx(r.form.email,t)||(r.form.email=t),o.CGJ(t)}),o.C$Y()()(),o.I0R(9,"div")(10,"p"),o.OEk(11,"Contrase\xf1a:"),o.C$Y(),o.I0R(12,"div",0)(13,"input",9),o.iHE("ngModelChange",function(t){o.usT(i);const r=o.GaO(3);return o.kNx(r.form.password,t)||(r.form.password=t),o.CGJ(t)}),o.C$Y()()(),o.I0R(14,"div",0)(15,"button",10),o.qCj("click",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.login())}),o.OEk(16,"Login"),o.C$Y()()(),o.I0R(17,"div",0)(18,"p"),o.OEk(19," \xbfOlvidaste tu contrase\xf1a?"),o.C$Y(),o.I0R(20,"button",11),o.qCj("click",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.enableResetPassword=!0)}),o.OEk(21," Recuperar contrase\xf1a "),o.C$Y()(),o.yuY(22,k,14,4,"div",12),o.I0R(23,"div",0)(24,"p"),o.OEk(25," \xbfNo tienes un usuario?"),o.C$Y(),o.I0R(26,"button",13),o.OEk(27,"Registrarse"),o.C$Y()()}if(2&e){const i=o.GaO(3);o.yG2(8),o.OKB("ngModel",i.form.email),o.yG2(5),o.OKB("ngModel",i.form.password),o.yG2(9),o.C0Y(22,i.enableResetPassword?22:-1),o.yG2(4),o.E7m("routerLink",o.q4q(4,I))}}function G(e,a){if(1&e&&o.yuY(0,O,2,0)(1,P,28,5),2&e){const i=o.GaO(2);o.C0Y(0,i.enableLoginWithEmailAndPassword?-1:0),o.yG2(),o.C0Y(1,i.enableLoginWithEmailAndPassword?1:-1)}}function Y(e,a){if(1&e&&o.yuY(0,v,7,2,"div",1)(1,G,2,2),2&e){const i=o.GaO();o.C0Y(0,i.user?0:1)}}function w(e,a){1&e&&(o.I0R(0,"div",0)(1,"p"),o.OEk(2,"cargando...."),o.C$Y()())}let $=(()=>{var e;class a{constructor(n,t){this.fb=n,this.router=t,this.authenticationService=(0,o.uUt)(g.A),this.cargando=!1,this.enableLoginWithEmailAndPassword=!1,this.datosForm=this.fb.group({email:["",[s.AQ.required,s.AQ.email]]}),this.enableResetPassword=!1,this.providers=[{name:"Iniciar sesi\xf3n con Google",id:"google",color:"#20a3df",textColor:"white"},{name:"Iniciar sesi\xf3n con Apple",id:"apple",color:"black",textColor:"white"},{name:"Iniciar sesi\xf3n con Facebook",id:"facebook",color:"#1871ed",textColor:"white"},{name:"Iniciar sesi\xf3n con correo y contrase\xf1a",id:"password",color:"#9e9e9e",textColor:"white"}],this.initForm(),this.cargando=!0,this.authenticationService.authState.subscribe(r=>{this.user=r||null,this.cargando=!1})}ngOnInit(){}loginWithProvider(n){var t=this;return(0,c.c)(function*(){if("password"==n.id)return void(t.enableLoginWithEmailAndPassword=!0);const r=yield t.authenticationService.getTokenOfProvider(n.id);console.log(`token: ${r} para hacer el login con -> ${n.id}`),yield t.authenticationService.loginWithTokenOfProvider(n.id,r),t.router.navigate(["user","perfil"])})()}initForm(){this.form={email:"",password:""}}login(){var n=this;return(0,c.c)(function*(){var t,r;if(null!==(t=n.form)&&void 0!==t&&t.email&&null!==(r=n.form)&&void 0!==r&&r.password)try{yield n.authenticationService.login(n.form.email,n.form.password)}catch(l){console.log("login error -> ",l)}})()}resetPassword(){var n=this;return(0,c.c)(function*(){if(n.datosForm.valid){const t=n.datosForm.value;console.log("valid -> ",t);try{yield n.authenticationService.sendPasswordResetEmail(t.email),n.enableResetPassword=!1,console.log("te hemos enviado un correo para reestablecer tu contrase\xf1a")}catch(r){console.log("resetPassword error -> ",r)}}})()}}return(e=a).\u0275fac=function(n){return new(n||e)(o.GI1(s.im),o.GI1(u.E5))},e.\u0275cmp=o.In1({type:e,selectors:[["app-login"]],decls:6,vars:1,consts:[[2,"text-align","center"],["style","margin: 20px;"],[2,"margin","20px"],[3,"routerLink"],[3,"ngStyle","click"],["style","text-align: center"],[2,"background-color","black","color","white",3,"click"],[1,"content"],["type","text",3,"ngModel","ngModelChange"],["type","password",3,"ngModel","ngModelChange"],[3,"click"],[1,"registrarse",3,"click"],["class","content-form"],[1,"button-gris",3,"routerLink"],[1,"content-form"],[3,"formGroup","ngSubmit"],[1,"input-content"],["placeholder","Email","formControlName","email"],[4,"ngIf"],["style","text-align: end;",4,"ngIf"],["type","submit",3,"disabled"],["type","button",3,"click"],[2,"text-align","end"]],template:function(n,t){1&n&&(o.I0R(0,"ion-content")(1,"div",0)(2,"p"),o.OEk(3,"LOGIN"),o.C$Y()(),o.yuY(4,Y,2,1)(5,w,3,0),o.C$Y()),2&n&&(o.yG2(4),o.C0Y(4,t.cargando?5:4))},dependencies:[p.u_,p.Qt,u.ER,C._i,s.sz,s.ot,s.ue,s.u,s._G,s.uW,s.Wo],styles:[".content[_ngcontent-%COMP%]{margin:15px;border:1px dotted #9E9E9E;padding:20px}input[_ngcontent-%COMP%]{padding:15px;width:90%;border-radius:5px}button[_ngcontent-%COMP%]{padding:10px;background-color:#7fffd4;border-radius:5px;margin:10px}img[_ngcontent-%COMP%]{max-width:100px}.button-gris[_ngcontent-%COMP%]{background-color:#d7d8da}.content-form[_ngcontent-%COMP%]{margin:15px;border:1px dotted #9E9E9E;padding:20px}span[_ngcontent-%COMP%]{color:red;width:100%;display:flex;margin-bottom:15px}"]}),a})();var m=d(5494),f=d(6576);function T(e,a){1&e&&(o.I0R(0,"span")(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function q(e,a){1&e&&(o.I0R(0,"span",13)(1,"i"),o.OEk(2,"Ingresa un email "),o.I0R(3,"strong"),o.OEk(4,"v\xe1lido"),o.C$Y()()())}function S(e,a){1&e&&(o.I0R(0,"span",13)(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function M(e,a){1&e&&(o.I0R(0,"span",13)(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function A(e,a){1&e&&(o.I0R(0,"span",13)(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function F(e,a){1&e&&(o.I0R(0,"span",13)(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}const L=()=>["/user/login"];let N=(()=>{var e;class a{constructor(n,t){this.fb=n,this.router=t,this.authenticationService=(0,o.uUt)(g.A),this.firestoreService=(0,o.uUt)(f.Y),this.datosForm=this.fb.group({email:["",[s.AQ.required,s.AQ.email]],password:["",s.AQ.required],name:["",s.AQ.required],photo:["",s.AQ.required],age:[null,s.AQ.required]}),this.cargando=!1}ngOnInit(){}registrarse(){var n=this;return(0,c.c)(function*(){if(n.cargando=!0,console.log("datosForm -> ",n.datosForm),n.datosForm.valid){const t=n.datosForm.value;console.log("valid -> ",t);try{const r=yield n.authenticationService.createUser(t.email,t.password);let l={displayName:t.name,photoURL:t.photo};yield n.authenticationService.updateProfile(l);const _={name:t.name,photo:t.photo,age:t.age,id:r.user.uid,email:t.email};console.log("datosUser -> ",_),yield n.firestoreService.createDocument(m.w.Auth.PathUsers,_,r.user.uid),console.log("usuario creado con \xe9xito"),n.router.navigate(["/user/perfil"])}catch(r){console.log("registrarse error -> ",r)}}n.cargando=!1})()}}return(e=a).\u0275fac=function(n){return new(n||e)(o.GI1(s.im),o.GI1(u.E5))},e.\u0275cmp=o.In1({type:e,selectors:[["app-registro"]],decls:41,vars:10,consts:[[2,"text-align","center"],[1,"content-form"],[3,"formGroup","ngSubmit"],[1,"input-content"],["placeholder","Email","formControlName","email"],[4,"ngIf"],["style","text-align: end;",4,"ngIf"],["formControlName","password","type","password","minlength","6"],["formControlName","name","type","string"],["formControlName","age","type","number"],["formControlName","photo","type","string"],["type","submit",3,"disabled"],[1,"ingresar",3,"routerLink"],[2,"text-align","end"]],template:function(n,t){1&n&&(o.I0R(0,"ion-content")(1,"div",0)(2,"p"),o.OEk(3,"REGISTRARSE"),o.C$Y()(),o.I0R(4,"div",1)(5,"form",2),o.qCj("ngSubmit",function(){return t.registrarse()}),o.I0R(6,"div",3)(7,"label"),o.OEk(8,"Email"),o.C$Y(),o.wR5(9,"input",4),o.yuY(10,T,5,0,"span",5)(11,q,5,0,"span",6),o.C$Y(),o.I0R(12,"div",3)(13,"label"),o.OEk(14,"Contrase\xf1a"),o.C$Y(),o.wR5(15,"input",7),o.yuY(16,S,5,0,"span",6),o.C$Y(),o.I0R(17,"div",3)(18,"label"),o.OEk(19,"Nombre"),o.C$Y(),o.wR5(20,"input",8),o.yuY(21,M,5,0,"span",6),o.C$Y(),o.I0R(22,"div",3)(23,"label"),o.OEk(24,"Edad"),o.C$Y(),o.wR5(25,"input",9),o.yuY(26,A,5,0,"span",6),o.C$Y(),o.I0R(27,"div",3)(28,"label"),o.OEk(29,"Foto"),o.C$Y(),o.wR5(30,"input",10),o.yuY(31,F,5,0,"span",6),o.C$Y(),o.I0R(32,"div",0)(33,"button",11)(34,"strong"),o.OEk(35,"Registrarse"),o.C$Y()()()()(),o.I0R(36,"div",0)(37,"p"),o.OEk(38," \xbfYa tienes un usuario?"),o.C$Y(),o.I0R(39,"button",12),o.OEk(40,"Ingresar"),o.C$Y()()()),2&n&&(o.yG2(5),o.E7m("formGroup",t.datosForm),o.yG2(5),o.E7m("ngIf",t.datosForm.controls.email.hasError("required")),o.yG2(),o.E7m("ngIf",t.datosForm.controls.email.hasError("email")),o.yG2(5),o.E7m("ngIf",t.datosForm.controls.password.hasError("required")),o.yG2(5),o.E7m("ngIf",t.datosForm.controls.name.hasError("required")),o.yG2(5),o.E7m("ngIf",t.datosForm.controls.age.hasError("required")),o.yG2(5),o.E7m("ngIf",t.datosForm.controls.photo.hasError("required")),o.yG2(2),o.E7m("disabled",t.cargando),o.yG2(6),o.E7m("routerLink",o.q4q(9,L)))},dependencies:[p.u_,u.ER,C._i,s.sz,s.ot,s.O4,s.ue,s.u,s.El,s.uW,s.Wo],styles:["button[_ngcontent-%COMP%]{padding:10px;background-color:#7fffd4;border-radius:5px;margin:30px 10px 10px}.content-form[_ngcontent-%COMP%]{margin:15px;border:1px dotted #9E9E9E;padding:20px}input[_ngcontent-%COMP%]{margin:10px 0;padding:10px;border-radius:5px;border:1px solid #46a4ce;width:100%}.input-content[_ngcontent-%COMP%]{margin:10px}button[_ngcontent-%COMP%]{margin:10px;padding:10px 40px;border-radius:10px;background:#7fffd4}.ingresar[_ngcontent-%COMP%]{background-color:#d7d8da}span[_ngcontent-%COMP%]{color:red}"]}),a})();function U(e,a){if(1&e&&(o.I0R(0,"div"),o.wR5(1,"img",13),o.C$Y()),2&e){const i=o.GaO(3);o.yG2(),o.E7m("src",i.user.photoURL,o.K6U)}}function Q(e,a){1&e&&(o.I0R(0,"div"),o.wR5(1,"img",14),o.C$Y())}function z(e,a){1&e&&(o.I0R(0,"span",15),o.OEk(1,"correo verificado"),o.C$Y())}function J(e,a){if(1&e){const i=o.KQA();o.I0R(0,"span"),o.OEk(1,"correo no verificado"),o.C$Y(),o.I0R(2,"button",5),o.qCj("click",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.enviarCorreo())}),o.OEk(3,"enviar correo de verificaci\xf3n"),o.C$Y()}}function j(e,a){1&e&&(o.I0R(0,"span")(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function D(e,a){1&e&&(o.I0R(0,"span",24)(1,"i"),o.OEk(2,"Ingresa un email "),o.I0R(3,"strong"),o.OEk(4,"v\xe1lido"),o.C$Y()()())}function W(e,a){if(1&e){const i=o.KQA();o.I0R(0,"div",16)(1,"form",17),o.qCj("ngSubmit",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.actualizarEmail())}),o.I0R(2,"div",18)(3,"label"),o.OEk(4,"Nuevo email"),o.C$Y(),o.wR5(5,"input",19),o.yuY(6,j,5,0,"span",20)(7,D,5,0,"span",21),o.C$Y(),o.I0R(8,"div",0)(9,"button",22),o.qCj("click",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.enableActualizarEmail=!1)}),o.I0R(10,"strong"),o.OEk(11,"cancelar"),o.C$Y()(),o.I0R(12,"button",23)(13,"strong"),o.OEk(14,"actualizar"),o.C$Y()()()()()}if(2&e){const i=o.GaO(3);o.yG2(),o.E7m("formGroup",i.formNewEmail),o.yG2(5),o.E7m("ngIf",i.formNewEmail.controls.email.hasError("required")),o.yG2(),o.E7m("ngIf",i.formNewEmail.controls.email.hasError("email")),o.yG2(5),o.E7m("disabled",i.cargando)}}function K(e,a){if(1&e){const i=o.KQA();o.I0R(0,"div",25)(1,"p"),o.OEk(2,"Cambiar nombre de perfil:"),o.C$Y(),o.I0R(3,"div",0)(4,"input",26),o.iHE("ngModelChange",function(t){o.usT(i);const r=o.GaO(3);return o.kNx(r.newName,t)||(r.newName=t),o.CGJ(t)}),o.C$Y()(),o.I0R(5,"p"),o.OEk(6,"Cambiar foto de perfil:"),o.C$Y(),o.I0R(7,"div",0)(8,"input",26),o.iHE("ngModelChange",function(t){o.usT(i);const r=o.GaO(3);return o.kNx(r.newPhoto,t)||(r.newPhoto=t),o.CGJ(t)}),o.C$Y()(),o.I0R(9,"div",0)(10,"button",22),o.qCj("click",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.actualizarPerfil())}),o.OEk(11,"Actualizar"),o.C$Y(),o.I0R(12,"button",22),o.qCj("click",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.enableActualizarPerfil=!1)}),o.OEk(13,"Cancelar"),o.C$Y()()()}if(2&e){const i=o.GaO(3);o.yG2(4),o.OKB("ngModel",i.newName),o.yG2(4),o.OKB("ngModel",i.newPhoto)}}function B(e,a){1&e&&(o.I0R(0,"span",24)(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function V(e,a){1&e&&(o.I0R(0,"span",24)(1,"i"),o.OEk(2,"Debe tener al menos 1 mayuscula, 1 minuscula, un caracter especial, un n\xfamero y m\xednimo 8 caracteres"),o.C$Y()())}function H(e,a){1&e&&(o.I0R(0,"span",24)(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function X(e,a){1&e&&(o.I0R(0,"span",24)(1,"i"),o.OEk(2,"Las contrase\xf1as no "),o.I0R(3,"strong"),o.OEk(4,"coinciden"),o.C$Y()()())}function Z(e,a){if(1&e){const i=o.KQA();o.I0R(0,"div",16)(1,"form",17),o.qCj("ngSubmit",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.cambiarPassword())}),o.I0R(2,"div",18)(3,"label"),o.OEk(4,"Establecer contrase\xf1a"),o.C$Y(),o.I0R(5,"div",27),o.wR5(6,"input",28),o.I0R(7,"button",29),o.qCj("click",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.visible=!t.visible)}),o.OEk(8),o.C$Y()(),o.yuY(9,B,5,0,"span",21)(10,V,3,0,"span",21),o.C$Y(),o.I0R(11,"div",18)(12,"label"),o.OEk(13,"Repita la contrase\xf1a"),o.C$Y(),o.wR5(14,"input",30),o.yuY(15,H,5,0,"span",21)(16,X,5,0,"span",21),o.C$Y(),o.I0R(17,"div",0)(18,"button",22),o.qCj("click",function(){o.usT(i);const t=o.GaO(3);return o.CGJ(t.enableCambiarPassword=!1)}),o.I0R(19,"strong"),o.OEk(20,"cancelar"),o.C$Y()(),o.I0R(21,"button",23)(22,"strong"),o.OEk(23,"cambiar"),o.C$Y()()()()()}if(2&e){const i=o.GaO(3);o.yG2(),o.E7m("formGroup",i.formCambiarPassword),o.yG2(5),o.E7m("type",i.visible?"text":"password"),o.yG2(2),o.oRS(" ",i.visible?"ocultar":"ver"," "),o.yG2(),o.E7m("ngIf",i.formCambiarPassword.controls.newPassword.hasError("required")),o.yG2(),o.E7m("ngIf",i.formCambiarPassword.controls.newPassword.hasError("pattern")),o.yG2(5),o.E7m("ngIf",i.formCambiarPassword.controls.repetPassword.hasError("required")),o.yG2(),o.E7m("ngIf",i.formCambiarPassword.controls.repetPassword.hasError("notSame")),o.yG2(5),o.E7m("disabled",i.cargando)}}function oo(e,a){if(1&e){const i=o.KQA();o.I0R(0,"div",2)(1,"h3")(2,"i"),o.OEk(3,"Bienvienido"),o.C$Y()(),o.yuY(4,U,2,1,"div")(5,Q,2,0),o.I0R(6,"div"),o.yuY(7,z,2,0,"span",3)(8,J,4,0),o.C$Y(),o.I0R(9,"p",4)(10,"strong"),o.OEk(11,"Email:"),o.C$Y(),o.OEk(12),o.I0R(13,"button",5),o.qCj("click",function(){o.usT(i);const t=o.GaO(2);return o.CGJ(t.enableActualizarEmail=!0)}),o.OEk(14,"editar"),o.C$Y()(),o.yuY(15,W,15,4,"div",6),o.I0R(16,"p")(17,"strong"),o.OEk(18,"Nombre:"),o.C$Y(),o.OEk(19),o.C$Y(),o.I0R(20,"p")(21,"strong"),o.OEk(22,"Edad:"),o.C$Y(),o.I0R(23,"input",7),o.iHE("ngModelChange",function(t){o.usT(i);const r=o.GaO(2);return o.kNx(r.userProfile.age,t)||(r.userProfile.age=t),o.CGJ(t)}),o.C$Y(),o.I0R(24,"button",5),o.qCj("click",function(){o.usT(i);const t=o.GaO(2);return o.CGJ(t.actualizarEdad())}),o.OEk(25,"guardar"),o.C$Y()(),o.I0R(26,"button",8),o.qCj("click",function(){o.usT(i);const t=o.GaO(2);return o.CGJ(t.enableActualizarPerfil=!0)}),o.OEk(27," actualizar datos de perfil "),o.C$Y(),o.yuY(28,K,14,2,"div",9),o.C$Y(),o.I0R(29,"button",10),o.qCj("click",function(){o.usT(i);const t=o.GaO(2);return o.CGJ(t.enableCambiarPassword=!0)}),o.OEk(30," establecer contrase\xf1a "),o.C$Y(),o.yuY(31,Z,24,8,"div",6),o.I0R(32,"div")(33,"button",10),o.qCj("click",function(){o.usT(i);const t=o.GaO(2);return o.CGJ(t.eliminarCuenta())}),o.I0R(34,"strong"),o.OEk(35,"eliminar cuenta"),o.C$Y()()(),o.I0R(36,"div",11)(37,"button",12),o.qCj("click",function(){o.usT(i);const t=o.GaO(2);return o.CGJ(t.salir())}),o.OEk(38,"Salir"),o.C$Y()()}if(2&e){const i=o.GaO(2);o.yG2(4),o.C0Y(4,i.user.photoURL?4:5),o.yG2(3),o.C0Y(7,i.user.emailVerified?7:8),o.yG2(5),o.oRS(" ",i.user.email," "),o.yG2(3),o.C0Y(15,i.enableActualizarEmail?15:-1),o.yG2(4),o.oRS(" ",i.user.displayName,""),o.yG2(4),o.OKB("ngModel",i.userProfile.age),o.yG2(5),o.C0Y(28,i.enableActualizarPerfil?28:-1),o.yG2(3),o.C0Y(31,i.enableCambiarPassword?31:-1)}}const no=()=>["/user/login"];function to(e,a){1&e&&(o.I0R(0,"div",0)(1,"button",31),o.OEk(2,"Ingresar"),o.C$Y()()),2&e&&(o.yG2(),o.E7m("routerLink",o.q4q(1,no)))}function eo(e,a){if(1&e&&o.yuY(0,oo,39,8)(1,to,3,2,"div",1),2&e){const i=o.GaO();o.C0Y(0,i.user&&i.userProfile?0:-1),o.yG2(),o.C0Y(1,i.user?-1:1)}}function io(e,a){1&e&&(o.I0R(0,"div",0)(1,"p"),o.OEk(2,"cargando...."),o.C$Y()())}let ro=(()=>{var e;class a{constructor(n,t){this.fb=n,this.router=t,this.authenticationService=(0,o.uUt)(g.A),this.firestoreService=(0,o.uUt)(f.Y),this.newName="",this.newPhoto="",this.newAge=null,this.cargando=!1,this.iniciando=!0,this.formNewEmail=this.fb.group({email:["",[s.AQ.required,s.AQ.email]]}),this.enableActualizarEmail=!1,this.enableActualizarPerfil=!1,this.enableCambiarPassword=!1,this.visible=!1,this.isSame=r=>{var l;return console.log("input -> ",r.value),(null===(l=this.formCambiarPassword)||void 0===l||null===(l=l.value)||void 0===l?void 0:l.newPassword)!=(null==r?void 0:r.value)?{notSame:!0}:{}},this.formCambiarPassword=this.fb.group({newPassword:["",[s.AQ.required]],repetPassword:["",[s.AQ.required,this.isSame]]}),this.enableDeletePassword=!1,this.iniciando=!0,this.authenticationService.authState.subscribe(r=>{console.log("res -> ",r),r?(this.user=r,this.getDatosProfile(r.uid)):(this.user=null,this.iniciando=!1)})}ngOnInit(){}ionViewDidEnter(){console.log("ionViewDidEnter login");const n=this.authenticationService.getCurrentUser();n&&(this.user=n)}salir(){this.authenticationService.logout()}actualizarPerfil(){var n=this;return(0,c.c)(function*(){let t={};n.newName&&(t.displayName=n.newName),n.newPhoto&&(t.photoURL=n.newPhoto),yield n.authenticationService.updateProfile(t);const r=n.authenticationService.getCurrentUser(),l={name:r.displayName,photo:r.photoURL};yield n.firestoreService.updateDocument(`${m.w.Auth.PathUsers}/${r.uid}`,l),n.user=r})()}getDatosProfile(n){console.log("getDatosProfile -> ",n),this.firestoreService.getDocumentChanges(`${m.w.Auth.PathUsers}/${n}`).subscribe(t=>{t&&(this.userProfile=t,console.log("this.userProfile -> ",this.userProfile)),this.iniciando=!1})}actualizarEdad(){var n=this;return(0,c.c)(function*(){const t=n.authenticationService.getCurrentUser(),r={age:n.userProfile.age};yield n.firestoreService.updateDocument(`${m.w.Auth.PathUsers}/${t.uid}`,r),console.log("actualizado con \xe9xito")})()}actualizarEmail(){var n=this;return(0,c.c)(function*(){if(n.formNewEmail.valid){const t=n.formNewEmail.value;console.log("valid -> ",t);try{yield n.authenticationService.verifyBeforeUpdateEmail(t.email),yield n.authenticationService.logout(),n.router.navigate(["/user/login"]),console.log("te hemos enviado un correo para que puedas verificar tu nuevo correo, \n        verif\xedcalo e inicia sesi\xf3n con el nuevo correo, \n        caso contrario inicia sesi\xf3n con tu correo de siempre")}catch(r){console.log("error al actualizar el correo -> ",r),console.log("\xbfDeseas cerrar sesi\xf3n y volver a ingresar para realizar esta acci\xf3n?")}}})()}enviarCorreo(){var n=this;return(0,c.c)(function*(){yield n.authenticationService.sendEmailVerification(),console.log("correo enviado -> comprueba tu correo")})()}cambiarPassword(){var n=this;return(0,c.c)(function*(){if(console.log("this.formCambiarPassword -> ",n.formCambiarPassword),n.formCambiarPassword.valid){const t=n.formCambiarPassword.value;console.log("valid -> ",t);try{yield n.authenticationService.updatePassword(t.newPassword),n.enableCambiarPassword=!1,console.log("contrase\xf1a actualizada con \xe9xito")}catch(r){console.log("error al cambiar la contrase\xf1a -> ",r),console.log("\xbfDeseas cerrar sesi\xf3n y volver a ingresar para realizar esta acci\xf3n?")}}})()}eliminarCuenta(){var n=this;return(0,c.c)(function*(){try{const t=n.authenticationService.getCurrentUser();yield n.authenticationService.updatePassword("xxxxxx"),yield n.firestoreService.deleteDocument(`${m.w.Auth.PathUsers}/${t.uid}`),yield n.authenticationService.deleteUser(),console.log("cuenta eliminada con \xe9xito"),yield n.authenticationService.logout(),n.router.navigate(["/user/login"])}catch(t){console.log("error al eliminar la cuenta -> ",t),console.log("\xbfDeseas cerrar sesi\xf3n y volver a ingresar para realizar esta acci\xf3n?")}})()}}return(e=a).\u0275fac=function(n){return new(n||e)(o.GI1(s.im),o.GI1(u.E5))},e.\u0275cmp=o.In1({type:e,selectors:[["app-perfil"]],decls:6,vars:1,consts:[[2,"text-align","center"],["style","text-align: center"],[2,"margin","20px"],["style","color: green;"],[2,"margin","0px"],[1,"button-age",3,"click"],["class","content-form"],["type","number",1,"input-edad",3,"ngModel","ngModelChange"],[1,"button-gris",3,"click"],["class","content-actualizar"],[1,"button-gris",2,"margin-left","25px",3,"click"],[2,"text-align","right"],[1,"salir",3,"click"],[3,"src"],["src","https://i.pinimg.com/736x/0d/64/98/0d64989794b1a4c9d89bff571d3d5842.jpg"],[2,"color","green"],[1,"content-form"],[3,"formGroup","ngSubmit"],[1,"input-content"],["placeholder","Email","formControlName","email"],[4,"ngIf"],["style","text-align: end;",4,"ngIf"],[3,"click"],["type","submit",3,"disabled"],[2,"text-align","end"],[1,"content-actualizar"],["type","text",3,"ngModel","ngModelChange"],[1,"new-password"],["formControlName","newPassword","minlength","6",3,"type"],["type","button",3,"click"],["formControlName","repetPassword","type","password","minlength","6"],[1,"ingresar",3,"routerLink"]],template:function(n,t){1&n&&(o.I0R(0,"ion-content")(1,"div",0)(2,"p"),o.OEk(3,"PERFIL"),o.C$Y()(),o.yuY(4,eo,2,2)(5,io,3,0),o.C$Y()),2&n&&(o.yG2(4),o.C0Y(4,t.iniciando?5:4))},dependencies:[p.u_,u.ER,C._i,s.sz,s.ot,s.O4,s.ue,s.u,s.El,s._G,s.uW,s.Wo],styles:[".content[_ngcontent-%COMP%]{margin:15px;border:1px dotted #9E9E9E;padding:20px}input[_ngcontent-%COMP%]{padding:15px;width:90%;border-radius:5px;margin:5px 0 20px}.input-edad[_ngcontent-%COMP%]{max-width:60px;margin:0 10px}.button-age[_ngcontent-%COMP%], .button-gris[_ngcontent-%COMP%]{padding:10px;background-color:#d7d8da;border-radius:5px;margin:10px;width:unset}button[_ngcontent-%COMP%]{padding:10px;background-color:#7fffd4;border-radius:5px;margin:10px}img[_ngcontent-%COMP%]{max-width:100px}.content-actualizar[_ngcontent-%COMP%]{border:1px solid #d7d8da;padding:10px}.registrarse[_ngcontent-%COMP%]{background-color:#d7d8da}.salir[_ngcontent-%COMP%]{width:unset}.content-form[_ngcontent-%COMP%]{margin:15px;border:1px dotted #9E9E9E;padding:20px}span[_ngcontent-%COMP%]{color:red;width:100%;display:flex;margin-bottom:15px}.new-password[_ngcontent-%COMP%]{position:relative}.new-password[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#f0f8ff;width:unset;position:absolute;right:15%;margin:0;top:15px}.button-danger[_ngcontent-%COMP%]{background-color:red;color:#fff}"]}),a})();function ao(e,a){1&e&&(o.I0R(0,"span",11)(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function so(e,a){1&e&&(o.I0R(0,"span",11)(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function lo(e,a){1&e&&(o.I0R(0,"span",11)(1,"i"),o.OEk(2,"Este campo es "),o.I0R(3,"strong"),o.OEk(4,"requerido"),o.C$Y()()())}function co(e,a){if(1&e){const i=o.KQA();o.I0R(0,"div",2)(1,"form",3),o.qCj("ngSubmit",function(){o.usT(i);const t=o.GaO();return o.CGJ(t.completarRegistro())}),o.I0R(2,"div",4)(3,"label"),o.OEk(4,"Email"),o.C$Y(),o.wR5(5,"input",5),o.C$Y(),o.I0R(6,"div",4)(7,"label"),o.OEk(8,"Nombre"),o.C$Y(),o.wR5(9,"input",6),o.yuY(10,ao,5,0,"span",7),o.C$Y(),o.I0R(11,"div",4)(12,"label"),o.OEk(13,"Edad"),o.C$Y(),o.wR5(14,"input",8),o.yuY(15,so,5,0,"span",7),o.C$Y(),o.I0R(16,"div",4)(17,"label"),o.OEk(18,"Foto"),o.C$Y(),o.wR5(19,"input",9),o.yuY(20,lo,5,0,"span",7),o.C$Y(),o.I0R(21,"div",0)(22,"button",10)(23,"strong"),o.OEk(24,"Completar registro"),o.C$Y()()()()()}if(2&e){const i=o.GaO();o.yG2(),o.E7m("formGroup",i.datosFormCompleteRegistro),o.yG2(9),o.E7m("ngIf",i.datosFormCompleteRegistro.controls.name.hasError("required")),o.yG2(5),o.E7m("ngIf",i.datosFormCompleteRegistro.controls.age.hasError("required")),o.yG2(5),o.E7m("ngIf",i.datosFormCompleteRegistro.controls.photo.hasError("required")),o.yG2(2),o.E7m("disabled",i.cargando)}}function uo(e,a){1&e&&(o.I0R(0,"div",0)(1,"p"),o.OEk(2,"cargando..."),o.C$Y()())}let mo=(()=>{var e;class a{constructor(n,t){this.fb=n,this.router=t,this.authenticationService=(0,o.uUt)(g.A),this.firestoreService=(0,o.uUt)(f.Y),this.cargando=!1,this.iniciando=!0,this.datosFormCompleteRegistro=this.fb.group({email:["",[s.AQ.required,s.AQ.email]],name:["",s.AQ.required],photo:["",s.AQ.required],age:[null,s.AQ.required]}),this.authenticationService.authState.subscribe(r=>{r&&(this.user=r,this.datosFormCompleteRegistro.setValue({email:r.email,name:r.displayName,photo:r.photoURL,age:null})),this.iniciando=!1})}ngOnInit(){}completarRegistro(){var n=this;return(0,c.c)(function*(){if(n.cargando=!0,console.log("datosFormCompleteRegistro -> ",n.datosFormCompleteRegistro),n.datosFormCompleteRegistro.valid){const t=n.datosFormCompleteRegistro.value;console.log("valid -> ",t);try{let r={displayName:t.name,photoURL:t.photo};const l=n.authenticationService.getCurrentUser();yield n.authenticationService.updateProfile(r);const _={name:t.name,photo:t.photo,age:t.age,id:l.uid,email:t.email};console.log("datosUser -> ",_),yield n.firestoreService.createDocument(m.w.Auth.PathUsers,_,l.uid),console.log("completado registro con \xe9xito"),n.router.navigate(["/user/perfil"])}catch(r){console.log("registrarse error -> ",r)}}n.cargando=!1})()}}return(e=a).\u0275fac=function(n){return new(n||e)(o.GI1(s.im),o.GI1(u.E5))},e.\u0275cmp=o.In1({type:e,selectors:[["app-completar-registro"]],decls:6,vars:1,consts:[[2,"text-align","center"],["class","content-form"],[1,"content-form"],[3,"formGroup","ngSubmit"],[1,"input-content"],["placeholder","Email","formControlName","email","readonly",""],["formControlName","name","type","string"],["style","text-align: end;",4,"ngIf"],["formControlName","age","type","number"],["formControlName","photo","type","string"],["type","submit",3,"disabled"],[2,"text-align","end"]],template:function(n,t){1&n&&(o.I0R(0,"ion-content")(1,"div",0)(2,"p"),o.OEk(3,"COMPLETAR REGISTRO"),o.C$Y()(),o.yuY(4,co,25,5,"div",1)(5,uo,3,0),o.C$Y()),2&n&&(o.yG2(4),o.C0Y(4,t.iniciando?5:4))},dependencies:[p.u_,C._i,s.sz,s.ot,s.O4,s.ue,s.u,s.uW,s.Wo],styles:["button[_ngcontent-%COMP%]{background-color:#7fffd4;margin:10px;padding:10px 40px;border-radius:10px;background:#7fffd4}.content-form[_ngcontent-%COMP%]{margin:15px;border:1px dotted #9E9E9E;padding:20px}input[_ngcontent-%COMP%]{margin:10px 0;padding:10px;border-radius:5px;border:1px solid #46a4ce;width:100%}.input-content[_ngcontent-%COMP%]{margin:10px}span[_ngcontent-%COMP%]{color:red}"]}),a})();var _o=d(248);const po=[{path:"login",component:$},{path:"request-login",component:(()=>{var e;class a{constructor(n,t){this.route=n,this.router=t,this.authenticationService=(0,o.uUt)(g.A),this.firestoreService=(0,o.uUt)(f.Y),this.message="procesando...",this.getQueryParams(),this.getTokenOfProvider()}ngOnInit(){}getQueryParams(){const n=this.route.snapshot.queryParams;console.log("queryParams -> ",n),n.provider&&n.intentId&&(this.authenticationService.loginWithProvider(n.provider),this.router.navigate(["/user/request-login"],{queryParams:{intentId:n.intentId}}))}getTokenOfProvider(){var n=this;return(0,c.c)(function*(){const t=yield n.authenticationService.getRedirectResult();if(console.log("getRedirectResult -> ",t),t){n.message="redirigiendo...";const r=_o.KU.credentialFromResult(t);console.log("credential -> ",r),n.saveToken(r.idToken?r.idToken:r.accessToken)}})()}saveToken(n){var t=this;return(0,c.c)(function*(){const l=t.route.snapshot.queryParams.intentId;if(console.log("intentId -> ",l),console.log("saveToken -> ",n),l){const _=m.w.Auth.PathIntentsLogin,fo={token:n};yield t.firestoreService.updateDocument(`${_}/${l}`,fo),t.authenticationService.logout(),console.log("guardado token con \xe9xito")}})()}}return(e=a).\u0275fac=function(n){return new(n||e)(o.GI1(u.gV),o.GI1(u.E5))},e.\u0275cmp=o.In1({type:e,selectors:[["app-request-login"]],decls:4,vars:1,consts:[[1,"content-center"]],template:function(n,t){1&n&&(o.I0R(0,"ion-content")(1,"div",0)(2,"p"),o.OEk(3),o.C$Y()()()),2&n&&(o.yG2(3),o.cNF(t.message))},dependencies:[C._i],styles:[".content-center[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)}"]}),a})()},{path:"registro",component:N},{path:"completar-registro",component:mo},{path:"perfil",component:ro}];let Co=(()=>{var e;class a{}return(e=a).\u0275fac=function(n){return new(n||e)},e.\u0275mod=o.a4G({type:e}),e.\u0275inj=o.s3X({imports:[u.qQ.forChild(po),u.qQ]}),a})(),go=(()=>{var e;class a{}return(e=a).\u0275fac=function(n){return new(n||e)},e.\u0275mod=o.a4G({type:e}),e.\u0275inj=o.s3X({imports:[p.MD,Co,C._i,s.y,s.sl]}),a})()}}]);